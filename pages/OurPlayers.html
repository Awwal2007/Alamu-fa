<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Squad - Alamu Football Academy (AFA)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="/image/alamu.png" type="image/png">
    <style>
        :root {
            --gold: #007BFF;
            --red: #003366;
            --white: #FFFFFF;
            --dark-red: #002244;
            --light-gold: #E6F2FF;
            --dark-gold: #0056B3;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--light-gray); color: var(--dark-gray); line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; } 
        
        /* Header */
        header { background: linear-gradient(135deg, var(--gold), var(--dark-red)); color: var(--white); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo-text h1 { font-size: 1.2rem; font-weight: 700; }
        .logo-text p { font-size: 0.9rem; opacity: 0.9; }
        .logo-image img { width: 100px; height: auto; transition: transform 0.3s; }
        .logo-image img:hover { transform: scale(1.1); }
        
        nav ul { display: flex; list-style: none; gap: 25px; }
        nav a { color: var(--white); text-decoration: none; font-weight: 500; font-size: 1.1rem; transition: all 0.3s ease; padding: 5px 10px; border-radius: 4px; }
        nav a:hover { background: rgba(255, 255, 255, 0.1); color: var(--gold); }
        .mobile-menu-btn { display: none; background: none; border: none; color: var(--white); font-size: 1.5rem; cursor: pointer; }

        /* Banner */
        .page-banner { background: linear-gradient(rgba(0, 34, 68, 0.8), rgba(0, 51, 102, 0.8)), url('image/playes1.jpg'); background-size: cover; background-position: center; padding: 80px 0; text-align: center; color: var(--white); }
        .page-banner h1 { font-size: 3rem; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 2px; }

        /* Squad Section */
        .squad-section { padding: 60px 0; }
        
        /* Add Player Button */
        .add-player-container { display: flex; justify-content: center; margin-bottom: 30px; }
        .add-player-btn { background: var(--dark-red); color: var(--white); padding: 12px 30px; border-radius: 50px; border: none; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 10px; font-size: 1rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .add-player-btn:hover { background: var(--gold); transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }

        /* Filters */
        .squad-filters { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin-bottom: 50px; }
        .filter-btn { background: var(--white); border: 2px solid var(--gold); color: var(--gold); padding: 10px 25px; border-radius: 30px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; font-size: 0.9rem; }
        .filter-btn:hover, .filter-btn.active { background: var(--gold); color: var(--white); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3); }

        /* Grid */
        .players-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        
        /* Player Card */
        .player-card { background: var(--white); border-radius: 12px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.08); transition: all 0.3s ease; position: relative; border-bottom: 4px solid var(--gold); }
        .player-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .card-img-wrapper { height: 350px; width: 100%; overflow: hidden; position: relative; background: #e0e0e0; }
        .card-img-wrapper img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .player-card:hover .card-img-wrapper img { transform: scale(1.05); }
        .player-jersey { position: absolute; top: 15px; right: 15px; width: 50px; height: 50px; background: var(--red); color: var(--white); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; font-weight: 800; border: 2px solid var(--white); z-index: 2; }
        .player-details { padding: 20px; text-align: center; }
        .player-name { font-size: 1.4rem; color: var(--dark-red); margin-bottom: 5px; font-weight: 700; }
        .player-pos-label { display: inline-block; background: var(--light-gold); color: var(--dark-gold); padding: 4px 12px; border-radius: 4px; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; margin-bottom: 15px; }
        .player-stats-row { display: flex; justify-content: space-around; border-top: 1px solid #eee; padding-top: 15px; }
        .p-stat { display: flex; flex-direction: column; }
        .p-stat span:first-child { font-size: 1.1rem; font-weight: 700; color: var(--dark-gray); }
        .p-stat span:last-child { font-size: 0.75rem; color: #888; text-transform: uppercase; }

        /* --- PROFESSIONAL MODAL STYLES --- */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
        .modal-content { background-color: var(--white); margin: 3% auto; padding: 0; border-radius: 15px; width: 90%; max-width: 700px; box-shadow: 0 15px 40px rgba(0,0,0,0.2); animation: slideDown 0.4s ease; }
        @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-header { background: linear-gradient(135deg, var(--gold), var(--dark-red)); padding: 20px 30px; border-radius: 15px 15px 0 0; display: flex; justify-content: space-between; align-items: center; color: var(--white); }
        .modal-header h2 { margin: 0; font-size: 1.5rem; }
        .close-modal { color: var(--white); font-size: 28px; font-weight: bold; cursor: pointer; }
        .modal-body { padding: 30px; max-height: 80vh; overflow-y: auto; }

        /* Form Styling */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .full-width { grid-column: 1 / -1; }
        .form-group { margin-bottom: 5px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark-gray); font-size: 0.9rem; }
        .form-control { width: 100%; padding: 12px 15px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; background: #fafafa; }
        .form-control:focus { border-color: var(--gold); outline: none; background: #fff; }
        .submit-btn-form { background: var(--red); color: var(--white); width: 100%; padding: 15px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 700; cursor: pointer; margin-top: 20px; transition: background 0.3s; }
        .submit-btn-form:hover { background: var(--gold); }
        
        /* Section Dividers in Form */
        .form-section-title { grid-column: 1 / -1; margin-top: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--light-gold); font-size: 1.1rem; color: var(--dark-gold); font-weight: 700; }
        
        /* Hidden Class for Logic */
        .hidden { display: none; }

        /* CTA */
        .join-cta { background: var(--white); padding: 60px 0; text-align: center; margin-top: 40px; }
        .cta-btn { display: inline-block; background: var(--red); color: var(--white); padding: 15px 40px; border-radius: 50px; text-decoration: none; font-weight: 600; transition: background 0.3s; margin-top: 20px; }
        .cta-btn:hover { background: var(--gold); }

        /* Footer */
        footer { background: linear-gradient(135deg, var(--red), var(--dark-red)); color: var(--white); padding: 60px 0 20px; }
        footer a { color: var(--white); text-decoration: none; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px; }
        .footer-column h3 { font-size: 1.5rem; margin-bottom: 20px; position: relative; padding-bottom: 10px; }
        .footer-column h3::after { content: ''; position: absolute; width: 50px; height: 3px; background: var(--gold); bottom: 0; left: 0; }
        .contact-info li { margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .copyright { text-align: center; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); opacity: 0.8; }
        
        @media (max-width: 768px) {
            nav ul { display: none; position: absolute; top: 100%; left: 0; width: 100%; background: var(--dark-red); flex-direction: column; padding: 20px; gap: 15px; }
            nav ul.show { display: flex; }
            .mobile-menu-btn { display: block; }
            .form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class=" container logo">
                <div class="logo-image">
                    <img src="/image/alamu.png" alt="AFA Logo">
                </div>
                <div class="logo-text">
                    <h1>Alamu Football Academy (AFA)</h1>
                    <p>Our Pride ThierÂ Fear</p>
                </div>
            </div>
            
            <nav class="container">
                <ul id="nav-menu">
                    <li><a href="/index.html"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="/pages/about.html"><i class="fas fa-info-circle"></i> About</a></li>
                    <li><a href="/pages/squad.html" style="color: var(--gold);"><i class="fas fa-users"></i> Squad</a></li>
                    <li><a href="/pages/gallery.html"><i class="fas fa-images"></i> Gallery</a></li>
                    <li><a href="/pages/news.html"><i class="fas fa-newspaper"></i> News</a></li>
                    <li><a href="/pages/contact.html"><i class="fas fa-envelope"></i> Contact</a></li>
                    <li><a href="/admin.html"><i class="fas fa-user-shield"></i> Admin</a></li>
                </ul>
                <button class="mobile-menu-btn" id="mobile-menu">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <div class="page-banner">
        <div class="container">
            <h1>Our Squad</h1>
            <p>Meet the future stars of Nigerian Football</p>
        </div>
    </div>

    <section class="squad-section">
        <div class="container">
            <div class="add-player-container">
                <button id="openModalBtn" class="add-player-btn">
                    <i class="fas fa-plus-circle"></i> Add New Player
                </button>
            </div>

            <div class="squad-filters">
                <button class="filter-btn active" onclick="filterPlayers('all')">All Players</button>
                <button class="filter-btn" onclick="filterPlayers('Goalkeeper')">Goalkeepers</button>
                <button class="filter-btn" onclick="filterPlayers('Defender')">Defenders</button>
                <button class="filter-btn" onclick="filterPlayers('Midfielder')">Midfielders</button>
                <button class="filter-btn" onclick="filterPlayers('Forward')">Forwards</button>
            </div>

            <div class="players-grid" id="players-grid">
                <div style="text-align:center; width:100%; grid-column: 1/-1;">
                    <i class="fas fa-spinner fa-spin fa-2x" style="color: var(--gold);"></i>
                </div>
            </div>
        </div>
    </section>

    <div id="addPlayerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Add New Player</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addPlayerForm">
                    <div class="form-grid">
                        
                        <div class="form-section-title"><i class="fas fa-info-circle"></i> Basic Info</div>

                        <div class="form-group full-width">
                            <label for="pName">Full Name</label>
                            <input type="text" id="pName" class="form-control" placeholder="e.g. Ahmed Musa" required>
                        </div>
                        <div class="form-group">
                            <label for="pPosition">Position</label>
                            <select id="pPosition" class="form-control" required>
                                <option value="" disabled selected>Select Position</option>
                                <option value="Goalkeeper">Goalkeeper</option>
                                <option value="Defender">Defender</option>
                                <option value="Midfielder">Midfielder</option>
                                <option value="Forward">Forward</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pNumber">Jersey Number</label>
                            <input type="number" id="pNumber" class="form-control" placeholder="e.g. 10" required>
                        </div>

                        <div class="form-group">
                            <label for="pAge">Age</label>
                            <input type="number" id="pAge" class="form-control" placeholder="18">
                        </div>
                        <div class="form-group">
                            <label for="pGames">Games Played</label>
                            <input type="number" id="pGames" class="form-control" placeholder="0">
                        </div>
                        <div class="form-group full-width">
                            <label for="pGoals">Goals Scored</label>
                            <input type="number" id="pGoals" class="form-control" placeholder="0">
                        </div>

                        <div class="form-section-title"><i class="fas fa-phone"></i> Contact Details</div>
                        
                        <div class="form-group">
                            <label for="pGuidance">Guardian Contact (Phone)</label>
                            <input type="tel" id="pGuidance" name="guardianContactPhone" class="form-control" placeholder="+234 800 000 000" required>
                        </div>
                        <div class="form-group">
                            <label for="pEmail">Player/Guardian Email</label>
                            <input type="email" id="pEmail" name="playerEmail" class="form-control" placeholder="example@domain.com">
                        </div>
                        <div class="form-section-title"><i class="fas fa-graduation-cap"></i> Status</div>
                        
                        <div class="form-group full-width">
                            <label for="pStatus">Is the player a Student or Graduate?</label>
                            <select id="pStatus" class="form-control" required>
                                <option value="" disabled selected>Select Status</option>
                                <option value="Student">Student</option>
                                <option value="Graduate">Graduate</option>
                            </select>
                        </div>

                        <div id="studentFields" class="form-grid full-width hidden">
                            <div class="form-group">
                                <label for="pSchoolName">School Name</label>
                                <input type="text" id="pSchoolName" class="form-control" placeholder="e.g. Iwo Grammar School">
                            </div>
                            <div class="form-group">
                                <label for="pClass">Class/Grade</label>
                                <input type="text" id="pClass" class="form-control" placeholder="e.g. SSS 2">
                            </div>
                        </div>

                        <div id="graduateFields" class="form-grid full-width hidden">
                            <div class="form-group full-width">
                                <label for="pGradStatus">Occupation or University?</label>
                                <select id="pGradStatus" class="form-control">
                                    <option value="" disabled selected>Select Option</option>
                                    <option value="Occupation">Working (Occupation)</option>
                                    <option value="University">University</option>
                                </select>
                            </div>

                            <div id="occupationSpecific" class="form-group full-width hidden">
                                <label for="pOccupation">What Occupation?</label>
                                <input type="text" id="pOccupation" class="form-control" placeholder="e.g. Engineer, Business Owner">
                            </div>

                            <div id="uniSpecific" class="form-grid full-width hidden">
                                <div class="form-group">
                                    <label for="pUniName">School Name (University)</label>
                                    <input type="text" id="pUniName" class="form-control" placeholder="e.g. OAU, Unilag">
                                </div>
                                <div class="form-group">
                                    <label for="pDept">Department</label>
                                    <input type="text" id="pDept" class="form-control" placeholder="e.g. Economics">
                                </div>
                            </div>
                        </div>

                        <div class="form-section-title"><i class="fas fa-camera"></i> Player Photo</div>
                        <div class="form-group full-width">
                            <label for="pImgFile">Upload Image</label>
                            <input type="file" id="pImgFile" class="form-control" accept="image/*">
                            <small style="color:#666">Formats: JPG, PNG. Max size: 2MB.</small>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn-form">
                        <i class="fas fa-save"></i> Save Player
                    </button>
                </form>
            </div>
        </div>
    </div>

    <section class="join-cta">
        <div class="container">
            <h2>Do you have what it takes?</h2>
            <p style="margin-top: 10px; max-width: 600px; margin-left: auto; margin-right: auto; color: #555;">
                We are constantly looking for young talents to join our ranks. Check our requirements and trial dates.
            </p>
            <a href="/pages/contact.html" class="cta-btn">Register for Trials</a>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Contact Information</h3>
                    <ul class="contact-info">
                        <li><i class="fas fa-map-marker-alt"></i> AFA Campus, Iwo, Osun State, Nigeria</li>
                        <li><i class="fas fa-phone"></i> +234 123 456 7890</li>
                        <li><i class="fas fa-envelope"></i> contact@alamu-fa.com</li>
                    </ul>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="contact-info">
                        <li><a href="/index.html">Home</a></li>
                        <li><a href="/pages/about.html">About AFA</a></li>
                        <li><a href="/pages/squad.html">Our Squad</a></li>
                        <li><a href="/pages/activities.html">Activities</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Visit The Academy</h3>
                    <p>The Alamu Football Academy is open to visitors and prospective talents by appointment. Experience the passion and dedication of our team.</p>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 Alamu Football Academy (AFA) - All Rights Reserved | Designed with <i class="fas fa-heart" style="color: var(--gold);"></i> for the Game</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu');
        const navMenu = document.getElementById('nav-menu');
        mobileMenuBtn.addEventListener('click', () => { navMenu.classList.toggle('show'); });

        // Modal Logic
        const modal = document.getElementById('addPlayerModal');
        const openBtn = document.getElementById('openModalBtn');
        const closeBtn = document.querySelector('.close-modal');

        openBtn.addEventListener('click', () => { modal.style.display = 'block'; });
        closeBtn.addEventListener('click', () => { modal.style.display = 'none'; });
        window.addEventListener('click', (e) => { if (e.target == modal) { modal.style.display = 'none'; } });

        // --- CONDITIONAL FORM LOGIC ---
        const pStatus = document.getElementById('pStatus');
        const studentFields = document.getElementById('studentFields');
        const graduateFields = document.getElementById('graduateFields');
        const pGradStatus = document.getElementById('pGradStatus');
        const occupationSpecific = document.getElementById('occupationSpecific');
        const uniSpecific = document.getElementById('uniSpecific');

        // 1. Student vs Graduate Toggle
        pStatus.addEventListener('change', function() {
            // Reset visibility
            studentFields.classList.add('hidden');
            graduateFields.classList.add('hidden');

            if (this.value === 'Student') {
                studentFields.classList.remove('hidden');
            } else if (this.value === 'Graduate') {
                graduateFields.classList.remove('hidden');
            }
        });

        // 2. Graduate: Occupation vs University Toggle
        pGradStatus.addEventListener('change', function() {
            // Reset visibility
            occupationSpecific.classList.add('hidden');
            uniSpecific.classList.add('hidden');

            if (this.value === 'Occupation') {
                occupationSpecific.classList.remove('hidden');
            } else if (this.value === 'University') {
                uniSpecific.classList.remove('hidden');
            }
        });

        // Helper function to read file as a Base64 data URL string (Firestore compatible)
        function readFileAsDataURL(file) {
            return new Promise((resolve, reject) => {
                if (!file) {
                    resolve(null);
                    return;
                }
                // Add a size check to prevent massive files from crashing Firestore (max 1MB per document)
                // 500KB limit as a practical safety measure, considering Base64 encoding overhead
                const MAX_FILE_SIZE_BYTES = 500 * 1024; 
                if (file.size > MAX_FILE_SIZE_BYTES) { 
                    reject(new Error(`File "${file.name}" is too large (${(file.size / 1024).toFixed(2)} KB). Maximum allowed size is ${MAX_FILE_SIZE_BYTES / 1024} KB.`));
                    return;
                }
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, collection, getDocs, orderBy, query, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB9JVWFn9a6RjC-_7-RweStkBTbE9P1F1k",
            authDomain: "alamu-fc.firebaseapp.com",
            projectId: "alamu-fc",
            storageBucket: "alamu-fc.firebasestorage.app",
            messagingSenderId: "519243570056",
            appId: "1:519243570056:web:b4d95c7266beb61757f83d",
            measurementId: "G-3HDT240BLK"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app); 

        document.addEventListener('DOMContentLoaded', loadPlayers);

        async function loadPlayers() {
            const grid = document.getElementById('players-grid');
            grid.innerHTML = '<div style="text-align:center; width:100%; grid-column: 1/-1;"><i class="fas fa-spinner fa-spin fa-2x" style="color: var(--gold);"></i></div>';

            try {
                // Load players from the 'players' collection (approved players)
                const q = query(collection(db, 'players'), orderBy('number', 'asc'));
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    grid.innerHTML = '<div style="text-align:center; width:100%; grid-column: 1/-1; color:#777;">The squad is currently empty.</div>';
                    return;
                }

                grid.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    renderPlayerCard(doc.data(), grid);
                });

            } catch (error) {
                console.error("Error loading players:", error);
                grid.innerHTML = '<div style="text-align:center; width:100%; grid-column: 1/-1; color:red;">Could not load player data.</div>';
            }
        }

        function renderPlayerCard(data, container) {
            const imgSrc = data.img || '/image/players .jpg';
            const card = document.createElement('div');
            card.className = 'player-card';
            card.setAttribute('data-position', data.position);
            
            card.innerHTML = `
                <div class="player-jersey">${data.number}</div>
                <div class="card-img-wrapper">
                    <img src="${imgSrc}" alt="${data.name}" onerror="this.src='/image/players .jpg'">
                </div>
                <div class="player-details">
                    <div class="player-name">${data.name}</div>
                    <div class="player-pos-label">${data.position}</div>
                    <div class="player-stats-row">
                        <div class="p-stat"><span>${data.age || '--'}</span><span>Age</span></div>
                        <div class="p-stat"><span>${data.games || '0'}</span><span>Games</span></div>
                        <div class="p-stat"><span>${data.goals || '0'}</span><span>Goals</span></div>
                    </div>
                </div>
            `;
            container.appendChild(card);
        }

        // --- SUBMIT PLAYER APPLICATION ---
        document.getElementById('addPlayerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.querySelector('.submit-btn-form');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            btn.disabled = true;

            try {
                const fileInput = document.getElementById('pImgFile');
                let imageUrl = '/image/players .jpg'; // Default image

                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    imageUrl = await readFileAsDataURL(file); // Convert file to Base64
                }

                const status = document.getElementById('pStatus').value;
                const educationData = {
                    status: status,
                    schoolName: "",
                    class: "",
                    occupation: "",
                    uniName: "",
                    uniDept: ""
                };

                if (status === 'Student') {
                    educationData.schoolName = document.getElementById('pSchoolName').value;
                    educationData.class = document.getElementById('pClass').value;
                } else if (status === 'Graduate') {
                    const gradStatus = document.getElementById('pGradStatus').value;
                    if (gradStatus === 'Occupation') {
                        educationData.occupation = document.getElementById('pOccupation').value;
                    } else if (gradStatus === 'University') {
                        educationData.uniName = document.getElementById('pUniName').value;
                        educationData.uniDept = document.getElementById('pDept').value;
                    }
                }

                const playerData = {
                    name: document.getElementById('pName').value,
                    position: document.getElementById('pPosition').value,
                    number: parseInt(document.getElementById('pNumber').value),
                    age: parseInt(document.getElementById('pAge').value) || 0,
                    games: parseInt(document.getElementById('pGames').value) || 0,
                    goals: parseInt(document.getElementById('pGoals').value) || 0,
                    guardianContact: document.getElementById('pGuidance').value,
                    email: document.getElementById('pEmail').value,
                    img: imageUrl,
                    status: 'pending', // Initial status
                    createdAt: serverTimestamp(),
                    ...educationData
                };

                await addDoc(collection(db, 'player-applications'), playerData);
                
                alert('Application submitted successfully! It will be reviewed by the admin.');
                document.getElementById('addPlayerModal').style.display = 'none';
                e.target.reset();

            } catch (error) {
                console.error("Error submitting application: ", error);
                alert("Error submitting application. Please try again.");
            } finally {
                btn.innerHTML = '<i class="fas fa-save"></i> Save Player';
                btn.disabled = false;
            }
        });

        window.filterPlayers = function(category) {
            const cards = document.querySelectorAll('.player-card');
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }

            cards.forEach(card => {
                const position = card.getAttribute('data-position');
                if (category === 'all' || position === category) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        };
    </script>
</body>
</html>